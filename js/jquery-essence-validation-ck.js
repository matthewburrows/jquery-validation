/*
 * - jquery-essence-validation.js
 * - (c) 2013 Essence Digital | http://www.essencedigital.com
 *
 * - Credits: Matthew Burrows <matthew.burrows@essencedigital.com>
 */(function(e){var t=t||{};t.Validation=function(e,t){this._init("essenceValidation",e,t)};t.Validation.prototype={_getCommonFieldElements:function(){var t=this;return{_fieldContainer:function(e){return e.closest(t.opts.messageParent)},_buildMsgContainer:function(t){return e("<div>",{"class":"error-msg",html:t.data("errorMessage")})},_msgContainer:function(e){var n=e.closest(t.opts.messageParent);return n.find(".error-msg")}}},_removeFieldMessage:function(e){var t=this,n=this._getCommonFieldElements();n._fieldContainer(e).removeClass("error");n._msgContainer(e).remove()},_showFieldMessage:function(e){var t=this,n=this._getCommonFieldElements();if(!i){var r=n._fieldContainer(e),i=n._msgContainer(e),s=n._buildMsgContainer(e);r.hasClass("error")||r.addClass("error").append(s)}},_textValidation:function(e,t){if(e.val()===""){this._showFieldMessage(e);return t+=1}this._removeFieldMessage(e);return t},_emailValidation:function(e,t){var n=e.val(),r=/^\w+@[a-zA-Z_]+?\.[a-zA-Z]{2,3}$/;if(n===""||!n.match(r)){this._showFieldMessage(e);return t+=1}this._removeFieldMessage(e);return t},_radioValidation:function(e,t){if(!e.is(":checked")){this._showFieldMessage(e);return t+=1}this._removeFieldMessage(e);return t},_checkboxValidation:function(e,t){return this._radioValidation(e,t)},_selectValidation:function(e,t){if(!e.is(":selected")){this._showFieldMessage(e);return t+=1}this._removeFieldMessage(e);return t},_validateSubmission:function(){var t=this,n=0;e.each(t.fieldObjects,function(e,r){var i=t.$element.find(':input[name="'+r+'"]'),s=i.prop("type"),o="_"+s+"Validation";t[o]&&typeof t[o]=="function"?n=t[o](i,n):n=t._textValidation(i,n)});return n>0?!0:!1},_setSubmissionListener:function(){var e=this;this.$element.on({submit:function(t){var n=e._validateSubmission();n&&t.preventDefault()}})},_mapFieldMessage:function(e){var t=this,n=this.$element.find(':input[name="'+e+'"]');this.overwriteDefaultMessage&&this.overwriteDefaultMessage.hasOwnProperty(e)?n.data("errorMessage",t.overwriteDefaultMessage[e]):n.data("errorMessage",t.opts.defaultMessage)},_mapFormFields:function(){var t=this,n=this.$element.find(":input");n.each(function(n,r){var i=e(this),s=i.prop("name")||!1,o=i.data("required")||!1;if(o&&s&&e.inArray(s,t.fieldObjects)==-1){t.fieldObjects.push(s);t._mapFieldMessage(s)}})},_getDefaults:function(t){var n=this;return e.extend({},e.fn[n.type].defaults,t)},_init:function(t,n,r){this.type=t;this.$element=e(n);this.opts=this._getDefaults(r);this.fieldObjects=[];this.overwriteDefaultMessage=this.opts.hasOwnProperty("overwriteDefaultMessage")?this.opts.overwriteDefaultMessage:!1;this._setSubmissionListener();this._mapFormFields()}};e.extend(e.fn,{essenceValidation:function(n){return this.each(function(){var r=e(this),i=r.data("essenceValidation"),s=typeof n=="object"&&n;i||r.data("essenceValidation",i=new t.Validation(this,s));typeof n=="string"&&i[n]()})}});e.fn.essenceValidation.defaults={showMessages:!0,defaultMessage:"Please fill out this field",messageParent:"div"}})(jQuery);